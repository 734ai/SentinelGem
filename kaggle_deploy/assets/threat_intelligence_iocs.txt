# Indicators of Compromise (IoCs) Dataset
# Based on real-world threat intelligence and MITRE ATT&CK patterns
# Generated by: Muzan Sano for SentinelGem testing
# Sources: APT groups, Ransomware families, Banking trojans

## Malicious IP Addresses (C2 Infrastructure)
# APT29 (Cozy Bear) - Recent campaigns
185.220.101.42    # C2 server - Netherlands
203.124.47.89     # Data exfiltration server - Singapore  
178.32.145.67     # Command server - France
91.214.205.33     # Backup C2 - Russia
142.251.36.110    # Compromised legitimate server - USA

## Malicious Domains
# Phishing and C2 domains observed in wild
update-windows-security.bit.ly
data-backup-service.tk
secure-analytics.ml
microsoft-account-security.azurewebsites-secure.net
paypal-security-center.bit.ly
binance-crypto-rewards.net
apple-id-verification.com
amazon-security-alert.net
netflix-payment-update.org
crypto-wallet-recovery.com

## File Hashes (SHA256)
# Known malware samples
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855    # WinUpdate.exe trojan
a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3    # Ransomware payload
c8fed00eb2e87f1cee8e90ebbe870c190ac1d2dc4d1eb4b5a9b4b5e5c5f1a9d4    # Banking trojan
d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2    # Cryptominer
f7c3bc1d808e04732adf679965ccc34ca7ae3441b2b5b5c5c5c5c5c5c5c5c5c5    # Info stealer

## Registry Keys (Persistence Mechanisms)
HKLM\Software\Microsoft\Windows\CurrentVersion\Run\SecurityUpdater
HKLM\System\CurrentControlSet\Services\WinSecUpd
HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce\SystemCheck
HKLM\Software\Classes\exefile\shell\open\command\(Default)
HKLM\System\CurrentControlSet\Control\Session Manager\BootExecute

## Suspicious File Paths
C:\Windows\Temp\winupdate.exe
C:\Users\Public\sec_scan.bat
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup\update.vbs
C:\Windows\System32\drivers\etc\hosts    # Modified for DNS hijacking
%APPDATA%\Microsoft\Windows\Templates\normal.dotm    # Macro persistence

## Network Indicators
# User-Agent strings used by malware
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 Malware/1.0
WindowsUpdate/10.0    # Fake Windows Update traffic
Python-urllib/3.9     # Python-based malware
curl/7.68.0           # Automated downloads

# HTTP endpoints
/api/v1/beacon        # C2 beacon endpoint
/commands             # Command retrieval
/upload               # Data exfiltration
/config               # Configuration updates
/heartbeat            # Keep-alive signals

## Email Indicators
# Malicious email patterns
Subject: URGENT: Your account will be suspended
Subject: [SECURITY ALERT]
Subject: Congratulations! You've Won
Subject: Your payment has failed
Subject: Verify your identity immediately

# Sender patterns
*@micr0s0ft-online.com
*@paypal-security-center.*
*@amazon-security.*
*@apple-verification.*
*@crypto-rewards.*

## Process Indicators
# Suspicious process names and behaviors
winupdate.exe running from %TEMP%
powershell.exe with encoded commands
cmd.exe spawned by Office applications
svchost.exe network connections to external IPs
wmic.exe lateral movement commands

## YARA Rules Signatures
rule APT_WinUpdate_Trojan {
    meta:
        description = "Detects WinUpdate trojan variant"
        author = "SentinelGem Research"
        reference = "Internal threat analysis"
    strings:
        $s1 = "winupdate.exe" nocase
        $s2 = "C:\\Windows\\Temp\\" nocase
        $s3 = { 4D 5A 90 00 03 00 00 00 }  // PE header
        $s4 = "Mozilla/5.0 Windows Malware" nocase
    condition:
        all of them
}

## Attack Patterns (MITRE ATT&CK)
T1059.001    # PowerShell execution
T1055        # Process injection
T1105        # Ingress tool transfer
T1547.001    # Registry run keys persistence
T1057        # Process discovery
T1083        # File and directory discovery  
T1082        # System information discovery
T1020        # Automated exfiltration
T1041        # Exfiltration over C2 channel
T1070.001    # Clear Windows event logs

## Threat Actor TTPs
# APT29 (Cozy Bear)
- Spear-phishing emails with malicious attachments
- PowerShell-based post-exploitation
- Living-off-the-land techniques
- Cloud infrastructure abuse

# FIN7 
- Business email compromise
- Point-of-sale malware
- SQL injection attacks
- Fileless malware deployment

# Lazarus Group
- Cryptocurrency exchange targeting
- Supply chain attacks
- Custom malware families
- Social engineering tactics

## Current Threat Campaigns (August 2025)
Campaign: "WinUpdate"
- Target: Corporate networks
- Vector: Phishing emails with fake Windows updates
- Payload: Remote access trojan
- Persistence: Registry modifications and scheduled tasks
- Exfiltration: HTTPS to compromised servers

Campaign: "CryptoReward"
- Target: Individual cryptocurrency users
- Vector: Social media advertisements and email
- Payload: Credential harvesting and wallet theft
- Persistence: Browser extension modification
- Monetization: Direct cryptocurrency theft

Campaign: "ExecutiveWire"
- Target: Finance departments
- Vector: Business email compromise
- Payload: Social engineering for wire transfers
- Persistence: Email account compromise
- Monetization: Fraudulent money transfers
